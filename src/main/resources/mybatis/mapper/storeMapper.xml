<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.woojungcard.woojungcard.repository.StoreRepository">
	<select id="findById" resultType="com.woojungcard.woojungcard.domain.dto.StoreDTO">
	<![CDATA[
	select* from store
	]]>
	</select>
	<!-- 아이디 중복 체크 -->
	<select id="storeIdCheck" resultType="int" parameterType="com.woojungcard.woojungcard.domain.request.StoreIdCheckRequest">
		<![CDATA[
		SELECT
			count(*)
		FROM
			store
		WHERE
			business_number = #{businessNumber}
		]]>
	</select>
	
	<!-- 스토어 회원가입 -->
	<insert id ="storeSignUp" parameterType="com.woojungcard.woojungcard.domain.request.StoreSignUpRequest">
		<![CDATA[
			INSERT INTO
				store(business_Number,
				store_pwd,
				representative,
				store_name,
				store_zip_code,
				store_address1, 
				store_address2,
				business_type,
				business_start_date,
				store_tel,
				store_join_date,
				status,
				auth)		
			VALUES
				(#{businessNumber}, 
				#{storePwd},
				#{representative},
				#{storeName},
				#{storeZipCode},
				#{storeAddress1},
				#{storeAddress2},
				#{businessType},
				#{businessStartDate},
				#{storeTel},
				now(),
				"waiting",
				"store")
		]]>
	</insert>
	<!-- 스토어 정보 변경 -->
	<update id="storeInfoUpdate" parameterType="com.woojungcard.woojungcard.domain.request.StoreUpdateRequest">
		<![CDATA[
			UPDATE 
				store
			SET
				representative= #{representative},
				store_pwd=#{storePwd},
				store_zip_code=#{storeZipCode},
				store_address1=#{storeAddress1},
				store_address2=#{storeAddress2},
				store_tel=#{storeTel}
			WHERE 
				id= #{id}
		]]>
	</update>
	
	<select id="findBNById" parameterType="com.woojungcard.woojungcard.domain.request.StoreFindBNByIdRequest">
		<![CDATA[
			SELECT
				business_number
			FROM
				store
			WHERE
				id=#{id}
		]]>
	</select>
	<!-- 스토어 로그인 -->
	<select id = "storeLogin" resultType="com.woojungcard.woojungcard.domain.dto.StoreDTO" parameterType="com.woojungcard.woojungcard.domain.request.StoreLoginRequest">
		<![CDATA[
			SELECT
				id
			FROM
				store
			WHERE
				business_number = #{businessNumber} AND store_pwd = #{storePwd}
		]]>
	</select>

	
	<!-- 스토어 정보 조회 -->
	<!-- Get Store List -->
	<select id= "storeGetInfo" resultType="com.woojungcard.woojungcard.domain.response.StoreInfoResponse" parameterType="long">
		<![CDATA[
		SELECT
			business_Number,
			representative,
			store_name,
			store_zip_code,
			store_address1, 
			store_address2,
			business_type,
			business_start_date,
			store_tel,
			store_join_date,
			status,
			auth
		FROM
			store
		WHERE
			id = #{id}	
		]]>
	</select>
	<select id = "storeList" resultType="com.woojungcard.woojungcard.domain.dto.StoreDTO">
		<![CDATA[
    	SELECT
    		*
    	FROM
    		store
    	]]>
	</select>
</mapper>